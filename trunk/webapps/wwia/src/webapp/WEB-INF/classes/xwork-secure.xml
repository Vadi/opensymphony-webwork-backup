<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE xwork PUBLIC "-//OpenSymphony Group//XWork 1.0//EN" "http://www.opensymphony.com/xwork/xwork-1.0.dtd">
<xwork>
    <package name="secure" extends="default" namespace="/secure">
        <interceptors>
            <interceptor-stack name="default">
                <interceptor-ref name="auth"/>
                <interceptor-ref name="completeStack"/>
            </interceptor-stack>

            <interceptor-stack name="editStack">
                <interceptor-ref name="auth"/>
                <interceptor-ref name="component"/>
                <interceptor-ref name="servlet-config"/>
                <interceptor-ref name="static-params"/>
                <interceptor-ref name="params"/>
                <interceptor-ref name="prepare"/>
                <interceptor-ref name="model-driven"/>
                <interceptor-ref name="conversionError"/>
                <interceptor-ref name="workflow"/>
            </interceptor-stack>

            <interceptor-stack name="crudStack">
                <interceptor-ref name="auth"/>
                <interceptor-ref name="token"/>
                <interceptor-ref name="component"/>
                <interceptor-ref name="servlet-config"/>
                <interceptor-ref name="static-params"/>
                <interceptor-ref name="params"/>
                <interceptor-ref name="prepare"/>
                <interceptor-ref name="model-driven"/>
                <!-- We have params here twice because we use the first set of params to populate our model, then set the params on that -->
                <interceptor-ref name="params"/>
                <interceptor-ref name="conversionError"/>
                <interceptor-ref name="validation"/>
                <interceptor-ref name="workflow"/>
            </interceptor-stack>
        </interceptors>

        <default-interceptor-ref name="default"/>

        <action name="dashboard" class="org.hibernate.auction.web.actions.Dashboard">
            <result name="success">dashboard.jsp</result>
        </action>

        <action name="viewCategory" class="org.hibernate.auction.web.actions.categories.EditCategory">
            <interceptor-ref name="editStack"/>
            <result name="success">viewCategory.jsp</result>
        </action>

        <action name="editCategory" class="org.hibernate.auction.web.actions.categories.EditCategory">
            <interceptor-ref name="editStack"/>
            <result name="success">createCategory.jsp</result>
        </action>
        <action name="newCategory" class="org.hibernate.auction.web.actions.categories.EditCategory">
            <result name="success">createCategory.jsp</result>
        </action>
        <action name="saveCategory" class="org.hibernate.auction.web.actions.categories.EditCategory" method="saveCategory">
            <interceptor-ref name="crudStack"/>
            <result name="input">createCategory.jsp</result>
            <result name="success" type="redirect" >dashboard.action</result>
        </action>

        <action name="addItem" class="org.hibernate.auction.web.actions.items.AddItem">
            <result name="input">addItem.jsp</result>
            <result name="success" type="redirect">dashboard.action</result>
        </action>

        <action name="viewItem" class="org.hibernate.auction.web.actions.items.ViewItem">
            <result name="success">viewItem.jsp</result>
        </action>

        <action name="search" class="org.hibernate.auction.web.actions.Search">
            <interceptor-ref name="default"/>
            <interceptor-ref name="execAndWait"/>
            <result name="wait">search-wait.jsp</result>
            <result name="success" type="redirect">moreResults.action</result>
        </action>

        <action name="moreResults" class="org.hibernate.auction.web.actions.Search" method="moreResults">
            <result name="success">search.jsp</result>
        </action>

        <action name="updateProfile" class="org.hibernate.auction.web.actions.users.UpdateUser">
            <!-- note: two params here! -->
            <interceptor-ref name="servlet-config"/>
<!--            <interceptor-ref name="params"/>-->
            <interceptor-ref name="component"/>
            <interceptor-ref name="prepare"/>
            <interceptor-ref name="chain"/>
            <interceptor-ref name="model-driven"/>
            <interceptor-ref name="fileUpload"/>
            <interceptor-ref name="static-params"/>
            <interceptor-ref name="params"/>
            <interceptor-ref name="conversionError"/>
            <interceptor-ref name="validation"/>
            <interceptor-ref name="workflow"/>

            <result name="success" type="redirect">dashboard.action</result>
            <result name="input">updateProfile.jsp</result>
        </action>

        <action name="createUsers!default" class="org.hibernate.auction.web.actions.users.CreateUsers" method="default">
            <result name="input">createUsers.jsp</result>
        </action>

        <action name="createUsers" class="org.hibernate.auction.web.actions.users.CreateUsers">
            <interceptor-ref name="completeStack"/>
            <interceptor-ref name="token-session"/>

            <result name="input">createUsers.jsp</result>
            <result name="success" type="redirect">dashboard.action</result>
        </action>

    </package>

    <package name="secure-localized"  extends="secure" namespace="/secure/localized">
        <interceptors>
            <interceptor name="i18n" class="org.hibernate.auction.web.interceptors.I18nInterceptor"/>
            <interceptor-stack name="localized-default">
                <interceptor-ref name="default"/>
                <interceptor-ref name="i18n"/>
            </interceptor-stack>

            <interceptor-stack name="editStack">
                <interceptor-ref name="i18n"/>
                <interceptor-ref name="editStack"/>
            </interceptor-stack>

            <interceptor-stack name="crudStack">
                <interceptor-ref name="i18n"/>
                <interceptor-ref name="crudStack"/>
            </interceptor-stack>
        </interceptors>

        <default-interceptor-ref name="localized-default"/>

        <action name="viewCategory" class="org.hibernate.auction.web.actions.localized.CreateLocalizedCategory">
            <interceptor-ref name="editStack"/>
            <result name="success">viewCategory.jsp</result>
        </action>

        <action name="editCategory" class="org.hibernate.auction.web.actions.localized.CreateLocalizedCategory">
            <interceptor-ref name="editStack"/>
            <result name="success">createCategory.jsp</result>
        </action>
        <action name="newCategory" class="org.hibernate.auction.web.actions.localized.CreateLocalizedCategory">
            <result name="success">createCategory.jsp</result>
        </action>

        <action name="createCategory" class="org.hibernate.auction.web.actions.localized.CreateLocalizedCategory">
            <result name="input">createCategory.jsp</result>
            <result name="success" type="redirect">dashboard.action</result>
        </action>

        <action name="addItem" class="org.hibernate.auction.web.actions.localized.AddItem">
            <result name="input">addItem.jsp</result>
            <result name="success" type="redirect">dashboard.action</result>
        </action>

        <action name="categoryTree" class="org.hibernate.auction.web.actions.categories.CategoryPicker">
            <result name="success">/secure/localized/categoryTree.jsp</result>
        </action>

    </package>
</xwork>
