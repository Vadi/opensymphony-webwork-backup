Index: D:/projects/dojo/src/webui/WidgetManager.js
===================================================================
--- D:/projects/dojo/src/webui/WidgetManager.js	(revision 698)
+++ D:/projects/dojo/src/webui/WidgetManager.js	(working copy)
@@ -57,20 +57,30 @@
 		return ret;
 	}
 
+	// map of previousally discovered implementation names to constructors
 	var knownWidgetImplementations = [];
 
+	// support manually registered widget packages
+	var widgetPackages = ["dojo.webui.widgets"];
+
+	this.registerWidgetPackage = function(pname) {
+		widgetPackages.push(pname);
+	}
+
 	this.getImplementation = function(widgetName, ctorObject, mixins){
+
+			// try and find a name for the widget
 		var impl = this.getImplementationName(widgetName);
+				
 		if(impl){
-			var tclass = dojo.webui.widgets[impl];
-			// dj_debug("new dojo.webui.widgets."+impl+"()");
-			// dj_debug(new dojo.webui.widgets[impl]());
-			var item = new dojo.webui.widgets[impl](ctorObject);
+			
+			var item = new impl(ctorObject);
 			//alert(impl+": "+item);
 			return item;
 		}
+
+
 	}
-
 	this.getImplementationName = function(widgetName){
 		/*
 		 * This is the overly-simplistic implemention of getImplementation (har
@@ -98,21 +108,25 @@
 		// ...oh fuck it, for now we' hard-code in an "HTML" prefix and see if
 		// it dies, at which point we'll drop the prefix and just try to find
 		// the base class.
-		for(var x in dojo.webui.widgets){
-			var xlc = (new String(x)).toLowerCase();
-			if(dojo.render.html.capable){
-				if(("html"+widgetName).toLowerCase() == xlc){
-					knownWidgetImplementations[xlc] = x;
-					return x;
+		for (var i = 0; i < widgetPackages.length; i++) {
+			var pn = widgetPackages[i];
+			var pkg = dj_eval_object_path(pn);
+
+			for(var x in pkg){
+				var xlc = (new String(x)).toLowerCase();
+				if(dojo.render.html.capable){
+					if(("html"+widgetName).toLowerCase() == xlc){
+						knownWidgetImplementations[xlc] = pkg[x];
+						return pkg[x];
+					}
+				}else if(dojo.render.svg.capable){
+					if(("svg"+widgetName).toLowerCase() == xlc){
+						knownWidgetImplementations[xlc] = pkg[x];
+						return pkg[x];
+					}
 				}
-			}else if(dojo.render.svg.capable){
-				if(("svg"+widgetName).toLowerCase() == xlc){
-					knownWidgetImplementations[xlc] = x;
-					return x;
-				}
 			}
 		}
-
 	}
 
 	// FIXME: does it even belong in this name space?
