<!DOCTYPE HTML PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
<title>Setting Up Webwork 2 for Weblogic 6.1</title>
</head>
<body bgcolor="#FFFFFF">

<p align="left"><b>NOTE: The directory branch in which this document appears is 
solely for the generation of additional classes needed in order to run WebWork 2 
on BEA Weblogic Server 6.1 SP4.&nbsp; If you are not running Weblogic Server 
6.l, then you can ignore this entire directory branch.</b></p>

<h1 align="center">Running WebWork 2 on Weblogic Server 6.1</h1>
<p align="left">This document describes why WebWork 2 doesn't work &quot;as-is&quot; on 
Weblogic Server 6.1 and shows how to build an additional JAR that will fix the 
problems.</p>
<p align="left">Note: the service pack of Weblogic Server 6.1 used is SP4.</p>
<p align="left">The first part of this document describes the technical problems 
and the theoretical solution.&nbsp; If you simply want to get WebWork to work on 
your Weblogic Server, skip to
<a href="#Setting Up WebWork 2 to Run on Weblogic 6.1">here</a>.</p>
<h2 align="left">Why WebWork Doesn't Work</h2>
<p align="left">Weblogic 6.1 was published just prior to the finalization of the 
Servlet 2.3 specification. The incompatibility is that servlet filters and 
listeners in Weblogic 6.1 do not work with the 2.3 spec primarily because the servlet context 
is not retrieved in the same way.&nbsp; This causes virtually all filter 
initialization operations to fail with an <code>AbstractMethodError</code> exception.</p>

<h2 align="left">How WebWork Is Modified</h2>

<p align="left">In Servlet 
2.3, the servlet context is available from the session object; this is not true 
for Weblogic Server 6.1.&nbsp; Hence, filters and listeners must be modified to 
retrieve the servlet context from a different source; this is accomplished by 
retrieving the servlet context&nbsp; from the <code>FilterConfig</code> passed to the servlet 
filters during initialzation.</p>

<p align="left">However, the WebWork code cannot be modifed to do this, because 
this will break the Servlet 2.3 specification.&nbsp; The goal is to leave the 
&quot;original&quot; WebWork modified so that it is still Servlet 2.3 compatible, and then 
to add an additional JAR that &quot;breaks&quot; WebWork to work on Weblogic Server 6.1.</p>

<p align="left">Hence, if you want to run WebWork under Servlet 2.3, the 
default, then simply build WebWork as usual.</p>

<p align="left">But if you want to run WebWork under Servlet 2.3, you need 
to build the additional JAR and put it into your WAR file, and then modify your 
web.xml to use the new classes instead of the standard ones.</p>

<p align="left">The standard WebWork has already been modified slightly to make 
the above effort possible:</p>

<ol>
  <li><code>RequestLifecycleFilter</code> is modified to retrieve its servlet context from
  		the method <code>getServletContext()</code>.  This method, <code>getServletContext()</code>,
  		is then implemented to return the servlet context from where it is available in
  		Servlet 2.3: the session object.&nbsp; The logical operation is 
  unchanged, but now subclasses can override <code>getServletContext()</code> to 
  retrieve the servlet context from a different location as we'll see below.</li>
  <li><code>SessionLifecycleListener</code> is modified in the same way as
  		<code>RequestLifecycleFilter</code>.  The method, <code>getServletContext()</code>,
  		is implemented to return the servlet context, in this case also from the session object.
  		Again, subclasses can override the <code>getServletContext()</code> method to restore
  		the servlet context from a different source.&nbsp; Again, this class's 
  functionality is unchanged.</li>
</ol>

<p align="left">Now, in a separate project, the following classes are added and 
compiled into a separate JAR:</p>

<h3>RequestLifecycleFilterCompatWeblogic61</h3>
<p>

</p>
<p align="left">This subclass of <code>RequestLifecycleFilter</code> simply 
overrides <code>getServletContext()</code> to retrieve the servlet context from 
the filter config, creates a singleton class, <code>SessionContextSingleton</code>, and
assigns the servlet context to the singleton so that the listeners will have the ability
to retrieve it.</p>

<h3 align="left">SessionLifecycleListenerCompatWeblogic61</h3>

<p align="left">This subclass of <code>SessionLifecycleListener</code> simply overrides 
<code>getServletContext()</code> to retrieve the servlet context from the singleton 
created above.</p>

<h3>FilterDispatcherCompatWeblogic61</h3>

<p align="left">Although the superclass of this class, <code>FilterDispatcher</code>, is 
commented out, this subclass retrieves the servlet context in the same way as 
<code>RequestLifecycleFilterCompatWeblogic61</code> in case it is ever resurrected.
At this time, this class is unnecessary.</p>

<h3 align="left">ServletContextSingleton</h3>

<p align="left">A singleton class whose sole purpose is to hold the servlet 
context so that listener classes have access to it.</p>

<h2 align="left"><a name="Setting Up WebWork 2 to Run on Weblogic 6.1">Setting 
Up WebWork 2 to Run on Weblogic 6.1</a></h2>

<h3>Running the Examples</h3>
<p>Here's all you do:</p>
<ol>
  <li>Build the Servlet 2.3 version of WebWork by invoking (at the top-level 
  directory of the WebWork source folder) the command:<br>
  <br>
  <code>ant example-war</code><br>
&nbsp;</li>
  <li>Build the WAR for Weblogic Server by invoking (in the same directory as 
  this document):<br>
  <br>
  <code>ant example-war</code><br>&nbsp;</li>
  <li>Copy the resulting WAR file, <code>webwork-weblogic61-example.war</code>, to your 
  Weblogic Server <code>mydomain/applications</code> directory.</li>
  <li>Launch Weblogic Server, and use a browser to look up the first page by 
  using the folloing (typical) URL:<br>
  <br>
  <a href="http://localhost:7001/webwork-weblogic61-example">
  http://localhost:7001/webwork-weblogic61-example</a><br>
  <br>
  This should bring up the examples front page.</li>
</ol>

<p align="center"><b><i>CAVEAT</i></b></p>
<p align="left"><b><i>As of this date, September 21, 2003, there are numerous 
bugs in the WebWork CVS project, and many of the examples do not work.</i></b></p>
<h3 align="left"><span style="font-weight: 400">Building Your Own Project</span></h3>
<p align="left">To build your own deployment, do the following:</p>
<ol>
  <li>
  <p align="left">When creating your WAR file, be sure to include the JAR file, 
  <code>webwork-weblogic61-2.0-beta.jar</code>, as well as the JAR files in the normal build.</li>
  <li>
  <p align="left">In the web.xml file, make the following class name 
  substitutions:<br>
  <br>
&nbsp;<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber1">
    <tr>
      <td align="center">
      <p align="center"><b>Old Class Name</b></td>
      <td align="center"><b>New Class Name</b></td>
    </tr>
    <tr>
      <td align="center"> <code>RequestLifecycleFilter</code> </td>
      <td align="center"> <code>RequestLifecycleFilterCompatWeblogic61</code></td>
    </tr>
    <tr>
      <td align="center"> <code>SessionLifecycleListener</code> </td>
      <td align="center"> <code>SessionLifecycleListenerCompatWeblogic61</code></td>
    </tr>
    <tr>
      <td align="center"> <code>FilterDispatcher</code></td>
      <td align="center"> <code>FilterDispatcherCompatWeblogic61</code></td>
    </tr>
  </table>
  </li>
</ol>

  <p align="left">&nbsp;</body></html>