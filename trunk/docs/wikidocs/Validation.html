<html>
    <head>
        <title>WebWork - 
        Validation
         </title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <p>WebWork relies on <a href="http://wiki.opensymphony.com//display/XW/XWork" title="XWork">XWork's</a> validation framework to enable the application of input validation rules to your Actions before they are executed.  This section only provides the bare minimum to get you started and focuses on WebWork's extension of the XWork validators to support client-side validation.  </p>

<p><em>Please consult XWork's <a href="http://wiki.opensymphony.com//display/XW/Validation+Framework" title="Validation Framework">validation framework documentation</a> for complete details.</em></p>

<div class="information-block" align='center'><div class='informationMacroPadding'><table cellpadding='5' width='85%' cellspacing='0' class='noteMacro' border='0'><tr><td width='16' valign='top'><img src="/images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>There is also an option for AJAX based asynchronous validation, please see <a href="Remote Form Validation.html" title="Remote Form Validation">Remote Form Validation</a> for more information.</td></tr></table></div></div>

<p><b>Reference pages</b></p>
<ol>
	<li><a href="Simple validators.html" title="Simple validators">Simple validators</a></li>
	<li><a href="Visitor validation.html" title="Visitor validation">Visitor validation</a></li>
	<li><a href="Client-Side Validation.html" title="Client-Side Validation">Client-Side Validation</a></li>
	<li><a href="Validation Examples.html" title="Validation Examples">Validation Examples</a></li>
</ol>



<h2><a name="Validation-RegisteringValidators">Registering Validators</a></h2>

<p>Validation rules are handled by validators, which must be registered with the ValidatorFactory.  The simplest way to do so is to add a file name <b>validators.xml</b> in the root of the classpath (/WEB-INF/classes) that declares all the validators you intend to use.  The syntax of the file is as follows:</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;validators&gt;</span>
    &lt;validator name=<span class="code-quote">"required"</span> 
        class=<span class="code-quote">"com.opensymphony.webwork.validators.JavaScriptRequiredFieldValidator"</span>/&gt;
    &lt;validator name=<span class="code-quote">"requiredstring"</span>
        class=<span class="code-quote">"com.opensymphony.webwork.validators.JavaScriptRequiredStringValidator"</span>/&gt;
    &lt;validator name=<span class="code-quote">"stringlength"</span>
        class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.StringLengthFieldValidator"</span>/&gt;
    &lt;validator name=<span class="code-quote">"int"</span>
        class=<span class="code-quote">"com.opensymphony.webwork.validators.JavaScriptIntRangeFieldValidator"</span>/&gt;
    &lt;validator name=<span class="code-quote">"date"</span>
        class=<span class="code-quote">"com.opensymphony.webwork.validators.JavaScriptDateRangeFieldValidator"</span>/&gt;
    &lt;validator name=<span class="code-quote">"expression"</span>
        class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.ExpressionValidator"</span>/&gt;
    &lt;validator name=<span class="code-quote">"fieldexpression"</span>
        class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.FieldExpressionValidator"</span>/&gt;
    &lt;validator name=<span class="code-quote">"email"</span>
        class=<span class="code-quote">"com.opensymphony.webwork.validators.JavaScriptEmailValidator"</span>/&gt;
    &lt;validator name=<span class="code-quote">"url"</span>
        class=<span class="code-quote">"com.opensymphony.webwork.validators.JavaScriptURLValidator"</span>/&gt;
    &lt;validator name=<span class="code-quote">"visitor"</span>
        class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.VisitorFieldValidator"</span>/&gt;
    &lt;validator name=<span class="code-quote">"conversion"</span>
        class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.ConversionErrorFieldValidator"</span>/&gt;
    &lt;validator name=<span class="code-quote">"regex"</span> 
        class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.RegexFieldValidator"</span>/&gt;
<span class="code-tag">&lt;/validators&gt;</span></pre>
</div></div>
<p>This list declares all the validators that comes with WebWork.</p>


<h2><a name="Validation-TurningonValidation">Turning on Validation</a></h2>

<p>All that is required to enable validation for an Action is to put the ValidationInterceptor in the interceptor refs of the action (see <a href="xwork.xml.html" title="xwork.xml">xwork.xml</a>) like so:</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;interceptor name=<span class="code-quote">"validator"</span> class=<span class="code-quote">"com.opensymphony.xwork.validator.ValidationInterceptor"</span>/&gt;</span></pre>
</div></div>

<p>Note: The default <b>validationWorkflowStack</b> already includes this.</p>


<h2><a name="Validation-DefiningValidationRules">Defining Validation Rules</a></h2>

<p>Validation rules can be specified:</p>

<ol>
	<li>Per Action class: in a file named ActionName-validation.xml</li>
	<li>Per Action alias: in a file named ActionName-alias-validation.xml</li>
	<li>Inheritance hierarchy and interfaces implemented by Action class: WebWork searches up the inheritance tree of the action to find default validations for parent classes of the Action and interfaces implemented</li>
</ol>


<p>Here is an example for SimpleAction-validation.xml:</p>

<div class="code"><div class="codeContent">
<pre class="code-xml">&lt;!DOCTYPE validators PUBLIC <span class="code-quote">"-//OpenSymphony Group//XWork Validator 1.0//EN"</span>
        <span class="code-quote">"http://www.opensymphony.com/xwork/xwork-validator-1.0.dtd"</span>&gt;
<span class="code-tag">&lt;validators&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"bar"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"required"</span>&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>You must enter a value for bar.<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"int"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"min"</span>&gt;</span>6<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"max"</span>&gt;</span>10<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>bar must be between ${min} and ${max}, current value is ${bar}.<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"bar2"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"regex"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"regex"</span>&gt;</span>[0-9],[0-9]<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>The value of bar2 must be in the format <span class="code-quote">"x, y"</span>, where x and y are between 0 and 9<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"date"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"date"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"min"</span>&gt;</span>12/22/2002<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"max"</span>&gt;</span>12/25/2002<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>The date must be between 12-22-2002 and 12-25-2002.<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"foo"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"int"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"min"</span>&gt;</span>0<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"max"</span>&gt;</span>100<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message key=<span class="code-quote">"foo.range"</span>&gt;</span>Could not find foo.range!<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
    <span class="code-tag">&lt;validator type=<span class="code-quote">"expression"</span>&gt;</span>
        <span class="code-tag">&lt;param name=<span class="code-quote">"expression"</span>&gt;</span>foo &gt; bar<span class="code-tag">&lt;/param&gt;</span>
        <span class="code-tag">&lt;message&gt;</span>Foo must be greater than Bar. Foo = ${foo}, Bar = ${bar}.<span class="code-tag">&lt;/message&gt;</span>
    <span class="code-tag">&lt;/validator&gt;</span>
<span class="code-tag">&lt;/validators&gt;</span></pre>
</div></div>

<p>Here we can see the configuration of validators for the SimpleAction class. Validators (and field-validators) must have a <b>type</b> attribute, which refers to a name of an Validator registered with the ValidatorFactory as above. Validator elements may also have &lt;param&gt; elements with name and value attributes to set arbitrary parameters into the Validator instance. See below for discussion of the message element.</p>

<p>Each Validator or Field-Validator element must define one message element inside the validator element body. The message element has 1 attributes, key which is not required. The body of the message tag is taken as the default message which should be added to the Action if the validator fails.</p>

<p>Key gives a message key to look up in the Action's ResourceBundles using getText() from LocaleAware if the Action implements that interface (as ActionSupport does). This provides for Localized messages based on the Locale of the user making the request (or whatever Locale you've set into the LocaleAware Action).</p>

<p>After either retrieving the message from the ResourceBundle using the Key value, or using the Default message, the current Validator is pushed onto the ValueStack, then the message is parsed for ${...} sections which are replaced with the evaluated value of the string between the ${ and }. This allows you to parameterize your messages with values from the Validator, the Action, or both. Here is an example of a parameterized message:</p>

<div class="code"><div class="codeContent">
<pre class="code-java">bar must be between ${min} and ${max}, current value is ${bar}.</pre>
</div></div>

<p>This will pull the min and max parameters from the IntRangeFieldValidator and the value of bar from the Action.</p>

                    			    </td>
		    </tr>
	    </table>
    </body>
</html>
