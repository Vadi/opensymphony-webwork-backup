<html>
    <head>
        <title>WebWork - 
        Validation Examples
         </title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <p>Included in the <a href="WebWork.html" title="WebWork">WW:WebWork</a> example war file is an example of using the <a href="http://wiki.opensymphony.com//display/XW/Validation+Framework" title="Validation Framework">XW:Validation Framework</a> in WebWork2. This example consists of three links which all use the same Action Class and view pages (Velocity).</p>
<h2><a name="ValidationExamples-Thesources">The sources</a></h2>

<p>First, I had to add the <b>validators.xml</b> file to the root of the source tree for the example app</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;validators&gt;</span>
    <span class="code-tag">&lt;validator name=<span class="code-quote">"required"</span> class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.RequiredFieldValidator"</span>/&gt;</span>
    <span class="code-tag">&lt;validator name=<span class="code-quote">"requiredstring"</span> class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.RequiredStringValidator"</span>/&gt;</span>
    <span class="code-tag">&lt;validator name=<span class="code-quote">"int"</span> class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.IntRangeFieldValidator"</span>/&gt;</span>
    <span class="code-tag">&lt;validator name=<span class="code-quote">"date"</span> class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.DateRangeFieldValidator"</span>/&gt;</span>
    <span class="code-tag">&lt;validator name=<span class="code-quote">"expression"</span> class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.ExpressionValidator"</span>/&gt;</span>
    <span class="code-tag">&lt;validator name=<span class="code-quote">"fieldexpression"</span> class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.FieldExpressionValidator"</span>/&gt;</span>
    <span class="code-tag">&lt;validator name=<span class="code-quote">"email"</span> class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.EmailValidator"</span>/&gt;</span>
    <span class="code-tag">&lt;validator name=<span class="code-quote">"url"</span> class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.URLValidator"</span>/&gt;</span>
    <span class="code-tag">&lt;validator name=<span class="code-quote">"visitor"</span> class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.VisitorFieldValidator"</span>/&gt;</span>
    <span class="code-tag">&lt;validator name=<span class="code-quote">"regex"</span> class=<span class="code-quote">"com.opensymphony.xwork.validator.validators.RegexFieldValidator"</span>/&gt;</span>
<span class="code-tag">&lt;/validators&gt;</span></pre>
</div></div>

<p>The Action class used by all of the validation examples is <b>ValidatedAction</b></p>
<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-keyword">package</span> com.opensymphony.webwork.example;

<span class="code-keyword">import</span> com.opensymphony.xwork.ActionSupport;

/**
 * ValidatedAction
 * @author Jason Carreira
 * Created Sep 12, 2003 9:23:38 PM
 */
<span class="code-keyword">public</span> class ValidatedAction <span class="code-keyword">extends</span> ActionSupport {
    <span class="code-keyword">private</span> ValidatedBean bean = <span class="code-keyword">new</span> ValidatedBean();
    <span class="code-keyword">private</span> <span class="code-object">String</span> name;
    <span class="code-keyword">private</span> <span class="code-object">String</span> validationAction = <span class="code-quote">"basicValidation.action"</span>;

    <span class="code-keyword">public</span> ValidatedBean getBean() {
        <span class="code-keyword">return</span> bean;
    }

    <span class="code-keyword">public</span> void setBean(ValidatedBean bean) {
        <span class="code-keyword">this</span>.bean = bean;
    }

    <span class="code-keyword">public</span> <span class="code-object">String</span> getName() {
        <span class="code-keyword">return</span> name;
    }

    <span class="code-keyword">public</span> void setName(<span class="code-object">String</span> name) {
        <span class="code-keyword">this</span>.name = name;
    }

    <span class="code-keyword">public</span> <span class="code-object">String</span> getValidationAction() {
        <span class="code-keyword">return</span> validationAction;
    }

    <span class="code-keyword">public</span> void setValidationAction(<span class="code-object">String</span> validationAction) {
        <span class="code-keyword">this</span>.validationAction = validationAction;
    }
}</pre>
</div></div>


<p>The base validation file for the ValidatedAction is <b>ValidatedAction-validation.xml</b></p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;!DOCTYPE validators PUBLIC <span class="code-quote">"-//OpenSymphony Group//XWork Validator 1.0//EN"</span> <span class="code-quote">"http://www.opensymphony.com/xwork/xwork-validator-1.0.dtd"</span>&gt;</span>
<span class="code-tag">&lt;validators&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"name"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"requiredstring"</span>&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>You must enter a name.<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
<span class="code-tag">&lt;/validators&gt;</span></pre>
</div></div>
<p>This and all other validation files are placed in the same package as the classes to which they apply.</p>

<p>The form for this Action is <b>validationForm.vm</b></p>
<div class="code"><div class="codeContent">
<pre class="code-html"><span class="code-tag">&lt;html&gt;</span>
<span class="code-tag">&lt;head&gt;</span><span class="code-tag">&lt;title&gt;</span>Webwork Validation Example<span class="code-tag">&lt;/title&gt;</span><span class="code-tag">&lt;/head&gt;</span>
<span class="code-tag">&lt;body&gt;</span>
#if( $actionErrors.size() &gt; 0 )
<span class="code-tag">&lt;p&gt;</span>
<span class="code-tag">&lt;font color=<span class="code-quote">"red"</span>&gt;</span>
<span class="code-tag">&lt;b&gt;</span>ERRORS:<span class="code-tag">&lt;/b&gt;</span><span class="code-tag">&lt;br&gt;</span>
<span class="code-tag">&lt;ul&gt;</span>
#foreach( $error in $actionErrors )
<span class="code-tag">&lt;li&gt;</span>$error<span class="code-tag">&lt;/li&gt;</span>
#end
<span class="code-tag">&lt;/ul&gt;</span>
<span class="code-tag">&lt;/font&gt;</span>
<span class="code-tag">&lt;/p&gt;</span>
#end
<span class="code-tag">&lt;p&gt;</span>
<span class="code-tag">&lt;form name=<span class="code-quote">"myForm"</span> action=<span class="code-quote">"${validationAction}"</span> method=<span class="code-quote">"POST"</span>&gt;</span>
<span class="code-tag">&lt;input type=<span class="code-quote">"hidden"</span> name=<span class="code-quote">"validationAction"</span> value=<span class="code-quote">"${validationAction}"</span>/&gt;</span>
Action Properties:
<span class="code-tag">&lt;br&gt;</span>
<span class="code-tag">&lt;table&gt;</span>
#tag( TextField <span class="code-quote">"label=Name"</span> <span class="code-quote">"name=name"</span> <span class="code-quote">"value=name"</span> )
<span class="code-tag">&lt;/table&gt;</span>
Bean Properties:
#if( $stack.findValue(<span class="code-quote">"fieldErrors"</span>) )
    #set( $beanErrors = $stack.findValue(<span class="code-quote">"fieldErrors.get('bean')"</span>) )
    #if( $beanErrors.size() &gt; 0 )
    <span class="code-tag">&lt;br&gt;</span>
    <span class="code-tag">&lt;font color=<span class="code-quote">"red"</span>&gt;</span>
    <span class="code-tag">&lt;b&gt;</span>Bean Errors:<span class="code-tag">&lt;/b&gt;</span><span class="code-tag">&lt;br&gt;</span>
    <span class="code-tag">&lt;ul&gt;</span>
    #foreach( $beanError in $beanErrors )
    <span class="code-tag">&lt;li&gt;</span>$beanError<span class="code-tag">&lt;/li&gt;</span>
    #end
    <span class="code-tag">&lt;/ul&gt;</span>
    <span class="code-tag">&lt;/font&gt;</span>
    #end
#end
<span class="code-tag">&lt;table&gt;</span>
#tag( TextField <span class="code-quote">"label=Bean.Text"</span> <span class="code-quote">"name=bean.text"</span> <span class="code-quote">"value=bean.text"</span> )<span class="code-tag">&lt;br&gt;</span>
#tag( TextField <span class="code-quote">"label=Bean.Date"</span> <span class="code-quote">"name=bean.date"</span> <span class="code-quote">"value=bean.date"</span> )<span class="code-tag">&lt;br&gt;</span>
#tag( TextField <span class="code-quote">"label=Bean.Number"</span> <span class="code-quote">"name=bean.number"</span> <span class="code-quote">"value=bean.number"</span> )<span class="code-tag">&lt;br&gt;</span>
#tag( TextField <span class="code-quote">"label=Bean.Number2"</span> <span class="code-quote">"name=bean.number2"</span> <span class="code-quote">"value=bean.number2"</span> )<span class="code-tag">&lt;br&gt;</span>
<span class="code-tag">&lt;/table&gt;</span>
<span class="code-tag">&lt;input type=<span class="code-quote">"submit"</span> value=<span class="code-quote">"Test Validation"</span>/&gt;</span>
<span class="code-tag">&lt;/form&gt;</span>
<span class="code-tag">&lt;/body&gt;</span></pre>
</div></div>

<p>The success page for these examples is a very simple page, <b>valid.vm</b></p>
<div class="code"><div class="codeContent">
<pre class="code-html"><span class="code-tag">&lt;html&gt;</span>
<span class="code-tag">&lt;head&gt;</span><span class="code-tag">&lt;title&gt;</span>WebWork Validation Test: Valid<span class="code-tag">&lt;/title&gt;</span><span class="code-tag">&lt;/head&gt;</span>
<span class="code-tag">&lt;body&gt;</span>
Input was valid!
<span class="code-tag">&lt;/body&gt;</span>
<span class="code-tag">&lt;/html&gt;</span></pre>
</div></div>

<p>We'll look at any other example-specific configuration files as we get to them.</p>
<h2><a name="ValidationExamples-BasicValidation"><a name="ValidationExamples-BasicValidation"></a> Basic Validation</a></h2>


<p>The BasicValidation example is defined in the example <b>xwork.xml</b> file like this</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;action name=<span class="code-quote">"basicValidation"</span> class=<span class="code-quote">"com.opensymphony.webwork.example.ValidatedAction"</span>&gt;</span>
            <span class="code-tag">&lt;interceptor-ref name=<span class="code-quote">"validationWorkflowStack"</span>/&gt;</span>

            <span class="code-tag">&lt;result name=<span class="code-quote">"success"</span> type=<span class="code-quote">"dispatcher"</span>&gt;</span>valid.vm<span class="code-tag">&lt;/result&gt;</span>
            <span class="code-tag">&lt;result name=<span class="code-quote">"input"</span> type=<span class="code-quote">"dispatcher"</span>&gt;</span>validationForm.vm<span class="code-tag">&lt;/result&gt;</span>
            <span class="code-tag">&lt;result name=<span class="code-quote">"error"</span> type=<span class="code-quote">"dispatcher"</span>&gt;</span>validationForm.vm<span class="code-tag">&lt;/result&gt;</span>
        <span class="code-tag">&lt;/action&gt;</span></pre>
</div></div>

<p>The <b>interceptor-ref</b> here, to <b>"validationWorkflowStack"</b>, is defined in webwork-default.xml and provides the parameter interceptors as well as the ValidationInterceptor (see <a href="http://wiki.opensymphony.com//display/XW/Validation+Framework" title="Validation Framework">XW:Validation Framework</a> and the DefaultWorkFlowInterceptor (see <a href="http://wiki.opensymphony.com//display/XW/Interceptors#Interceptors-DefaultWorkflow" title="DefaultWorkflow on Interceptors">XW:Interceptors#DefaultWorkflow</a>). All of the parameters from the configuration file (there are none in this case) followed by the parameters from the request will be set onto the Action. Next, the validations will be run, and finally the DefaultWorkflow will be applied (see <a href="http://wiki.opensymphony.com//display/XW/Interceptors#Interceptors-DefaultWorkflow" title="DefaultWorkflow on Interceptors">XW:Interceptors#DefaultWorkflow</a>).  </p>

<p>This example is very simple, and the ValidatedAction-validation.xml file is the only set of Validations which will be applied. This means that the only validation done is that you enter some text for the name field. </p>
<h2><a name="ValidationExamples-VisitorValidationExample"><a name="ValidationExamples-VisitorValidation"></a> Visitor Validation Example</a></h2>

<p><em>note: check out another <a href="VisitorFieldValidatorExample.html" title="VisitorFieldValidatorExample">Visitor Field Validator Example </a></em>.</p>

<p> The <b>ValidatedAction</b> holds a reference to a plain Java bean, <b>ValidatedBean</b>:</p>
<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-keyword">package</span> com.opensymphony.webwork.example;

<span class="code-keyword">import</span> java.util.Date;

/**
 * ValidatedBean
 * @author Jason Carreira
 * Created Sep 12, 2003 9:24:18 PM
 */
<span class="code-keyword">public</span> class ValidatedBean {
    <span class="code-keyword">private</span> <span class="code-object">String</span> text;
    <span class="code-keyword">private</span> Date date = <span class="code-keyword">new</span> Date(<span class="code-object">System</span>.currentTimeMillis());
    <span class="code-keyword">private</span> <span class="code-object">int</span> number;
    <span class="code-keyword">private</span> <span class="code-object">int</span> number2;
    <span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">final</span> <span class="code-object">int</span> MAX_TOTAL = 12;

    <span class="code-keyword">public</span> <span class="code-object">String</span> getText() {
        <span class="code-keyword">return</span> text;
    }

    <span class="code-keyword">public</span> void setText(<span class="code-object">String</span> text) {
        <span class="code-keyword">this</span>.text = text;
    }

    <span class="code-keyword">public</span> Date getDate() {
        <span class="code-keyword">return</span> date;
    }

    <span class="code-keyword">public</span> void setDate(Date date) {
        <span class="code-keyword">this</span>.date = date;
    }

    <span class="code-keyword">public</span> <span class="code-object">int</span> getNumber() {
        <span class="code-keyword">return</span> number;
    }

    <span class="code-keyword">public</span> void setNumber(<span class="code-object">int</span> number) {
        <span class="code-keyword">this</span>.number = number;
    }

    <span class="code-keyword">public</span> <span class="code-object">int</span> getNumber2() {
        <span class="code-keyword">return</span> number2;
    }

    <span class="code-keyword">public</span> void setNumber2(<span class="code-object">int</span> number2) {
        <span class="code-keyword">this</span>.number2 = number2;
    }
}</pre>
</div></div>

<p>The base validation file for the ValidatedBean is <b>ValidatedBean-validation.xml</b></p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;!DOCTYPE validators PUBLIC <span class="code-quote">"-//OpenSymphony Group//XWork Validator 1.0//EN"</span> <span class="code-quote">"http://www.opensymphony.com/xwork/xwork-validator-1.0.dtd"</span>&gt;</span>
<span class="code-tag">&lt;validators&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"text"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"requiredstring"</span>&gt;</span>
            <span class="code-tag">&lt;message key=<span class="code-quote">"invalid.text"</span>&gt;</span>Empty Text!<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"date"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"date"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"min"</span>&gt;</span>01/01/1970<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message key=<span class="code-quote">"invalid.date"</span>&gt;</span>Invalid Date!<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"number"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"int"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"min"</span>&gt;</span>1<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"max"</span>&gt;</span>10<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message key=<span class="code-quote">"invalid.number"</span>&gt;</span>Invalid Number!<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
<span class="code-tag">&lt;/validators&gt;</span></pre>
</div></div>

<p>In the Visitor Validation Example, we add a <b>VisitorFieldValidator</b> to apply these validations to our <b>ValidatedBean</b>. The Action is defined in our <b>xwork.xml</b> file like this:</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;action name=<span class="code-quote">"visitorValidation"</span> class=<span class="code-quote">"com.opensymphony.webwork.example.ValidatedAction"</span>&gt;</span>
            <span class="code-tag">&lt;interceptor-ref name=<span class="code-quote">"validationWorkflowStack"</span>/&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"validationAction"</span>&gt;</span>visitorValidation.action<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;result name=<span class="code-quote">"success"</span>&gt;</span>valid.vm<span class="code-tag">&lt;/result&gt;</span>
            <span class="code-tag">&lt;result name=<span class="code-quote">"input"</span>&gt;</span>validationForm.vm<span class="code-tag">&lt;/result&gt;</span>
            <span class="code-tag">&lt;result name=<span class="code-quote">"error"</span>&gt;</span>validationForm.vm<span class="code-tag">&lt;/result&gt;</span>
        <span class="code-tag">&lt;/action&gt;</span></pre>
</div></div>

<p>Here we see a slight difference from the basic validation example above. I've added a static param to the Action which will be applied to the Action by the static-param interceptor. This parameter only sets the value for the action to post the form to for validation (see <b>validationForm.vm</b>). </p>

<p>The Action name above, <em>visitorValidation</em> is mapped to another set of validations defined in the file <b>ValidatedAction-visitorValidation-validation.xml</b></p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;!DOCTYPE validators PUBLIC <span class="code-quote">"-//OpenSymphony Group//XWork Validator 1.0//EN"</span> <span class="code-quote">"http://www.opensymphony.com/xwork/xwork-validator-1.0.dtd"</span>&gt;</span>
<span class="code-tag">&lt;validators&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"bean"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"required"</span>&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>The bean must not be null.<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"visitor"</span>&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>bean: <span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
<span class="code-tag">&lt;/validators&gt;</span></pre>
</div></div>

<p>This file is found automatically by the validation framework based on the class name (ValidatedAction), the action alias, which is used as the validation context (visitorValidation) and the standard suffix (-validation.xml) to form the filename <b>ValidatedAction-visitorValidation-validation.xml</b>.</p>

<p>This file defines two validators for the "bean" field, a required validator which makes sure the bean is not null, and a VisitorFieldValidator. The VisitorFieldValidator will apply the validators for the <b>ValidatedBean</b> using the same validation context as is used in validating <b>ValidatedAction</b>, <em>visitorValidation</em>. It therefore looks for the validation files <b>ValidatedBean-validation.xml</b> (the default validations for the ValidatedBean) and <b>ValidatedBean-visitorValidation-validation.xml</b> (the validations specific to this validation context) , in that order.</p>

<p>The <b>ValidatedBean-validation.xml</b> looks like this:</p>

<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;!DOCTYPE validators PUBLIC <span class="code-quote">"-//OpenSymphony Group//XWork Validator 1.0//EN"</span> <span class="code-quote">"http://www.opensymphony.com/xwork/xwork-validator-1.0.dtd"</span>&gt;</span>
<span class="code-tag">&lt;validators&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"text"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"requiredstring"</span>&gt;</span>
            <span class="code-tag">&lt;message key=<span class="code-quote">"invalid.text"</span>&gt;</span>Empty Text!<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"date"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"date"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"min"</span>&gt;</span>01/01/1970<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message key=<span class="code-quote">"invalid.date"</span>&gt;</span>Invalid Date!<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"number"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"int"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"min"</span>&gt;</span>1<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"max"</span>&gt;</span>10<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message key=<span class="code-quote">"invalid.number"</span>&gt;</span>Invalid Number!<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
<span class="code-tag">&lt;/validators&gt;</span></pre>
</div></div>

<p>This file applies validations for three fields (text, date, and number) and gives message keys and default messages for each of them. These message keys will be used to look up messages from a resource bundle specific to the <b>ValidatedBean</b> class. In the same package as the <b>ValidatedBean</b> is a file named <b>ValidatedBean.properties</b></p>
<div class="code"><div class="codeContent">
<pre class="code-none">invalid.date=You must enter a date after ${min}.
invalid.text=You must enter some text.
invalid.number=You must enter a number between ${min} and ${max}.
invalid.total=The total of number and number2 must be less than $\{@com.opensymphony.webwork.example.ValidatedBean@MAX_TOTAL}.</pre>
</div></div>

<p>These messages will be used for any errors added for the <b>ValidatedBean</b> using a message key. As you can see from the body of the messages, they can be parameterized with properties from the Bean, the Interceptor, and the Action (and they will be searched in that order). There is also an example of using a Static field <b>${@com.opensymphony.webwork.example.ValidatedBean@MAX_TOTAL}</b>.</p>

<p>The <b>ValidatedBean-visitorValidation-validation.xml</b> file would define validations specific for the <em>visitorValidation</em> validation context, but it is not there, so it is ignored.</p>
<h2><a name="ValidationExamples-VisitorValidationwiththeExpressionValidator"><a name="ValidationExamples-Expression"></a> Visitor Validation with the Expression Validator</a></h2>

<p>The final example shows a similar setup to the previous visitor validation example. The <b>xwork.xml</b> configuration for this example is very similar to the <b>visitorValidation</b> example:</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;action name=<span class="code-quote">"expressionValidation"</span> class=<span class="code-quote">"com.opensymphony.webwork.example.ValidatedAction"</span>&gt;</span>
            <span class="code-tag">&lt;interceptor-ref name=<span class="code-quote">"validationWorkflowStack"</span>/&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"validationAction"</span>&gt;</span>expressionValidation.action<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;result name=<span class="code-quote">"success"</span>&gt;</span>valid.vm<span class="code-tag">&lt;/result&gt;</span>
            <span class="code-tag">&lt;result name=<span class="code-quote">"input"</span>&gt;</span>validationForm.vm<span class="code-tag">&lt;/result&gt;</span>
            <span class="code-tag">&lt;result name=<span class="code-quote">"error"</span>&gt;</span>validationForm.vm<span class="code-tag">&lt;/result&gt;</span>
        <span class="code-tag">&lt;/action&gt;</span></pre>
</div></div>

<p>The <b>ValidatedAction-expressionValidation-validation.xml</b> file defines the validations specific to this validation context:</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;!DOCTYPE validators PUBLIC <span class="code-quote">"-//OpenSymphony Group//XWork Validator 1.0//EN"</span> <span class="code-quote">"http://www.opensymphony.com/xwork/xwork-validator-1.0.dtd"</span>&gt;</span>
<span class="code-tag">&lt;validators&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"bean"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"required"</span>&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>The bean must not be null.<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"visitor"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"context"</span>&gt;</span>expression<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>bean: <span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
<span class="code-tag">&lt;/validators&gt;</span></pre>
</div></div>

<p>This is almost identical to the <b>ValidatedAction-visitorValidation-validation.xml</b> file, but shows an example of passing a context param to the <b>VisitorFieldValidator</b>. In this case, rather than using the same validation context as is used for the <b>ValidatedAction</b> (<em>expressionValidation</em>), it passes another context (<em>expression</em>) to be used instead. </p>

<p>In this case, the validation context specific validations for the <b>ValidatedBean</b> is present, and it's named <b>ValidatedBean-expression-validation.xml</b></p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;!DOCTYPE validators PUBLIC <span class="code-quote">"-//OpenSymphony Group//XWork Validator 1.0//EN"</span> <span class="code-quote">"http://www.opensymphony.com/xwork/xwork-validator-1.0.dtd"</span>&gt;</span>
<span class="code-tag">&lt;validators&gt;</span>
    <span class="code-tag">&lt;validator type=<span class="code-quote">"expression"</span>&gt;</span>
        <span class="code-tag">&lt;param name=<span class="code-quote">"expression"</span>&gt;</span>@com.opensymphony.webwork.example.ValidatedBean@MAX_TOTAL &gt; (number + number2)<span class="code-tag">&lt;/param&gt;</span>
        <span class="code-tag">&lt;message key=<span class="code-quote">"invalid.total"</span>&gt;</span>Invalid total!<span class="code-tag">&lt;/message&gt;</span>
    <span class="code-tag">&lt;/validator&gt;</span>
<span class="code-tag">&lt;/validators&gt;</span></pre>
</div></div>
<p>This adds an object-level (as opposed to field-level) ExpressionValidator which checks the total of the number and number2 fields against a static constant, and adds an error message if the total is more than the constant. </p>
<h2><a name="ValidationExamples-AnoteabouterrormessageswiththeVisitorFieldValidator"><a name="ValidationExamples-ErrorMessages"></a> A note about error messages with the VisitorFieldValidator</a></h2>

<p>With the VisitorFieldValidator, message field names are appended with the field name of the field in the Action. In this case, the fields "<em>text</em>", "<em>date</em>", and "<em>number</em>" in the <b>ValidatedBean</b> would be added as field error messages to the Action with field names "<em>bean.text</em>", "<em>bean.date</em>", and "<em>bean.number</em>". The error messages added for the object-level ExpressionValidator applied in the last example will be added as field-level errors to the Action with the name "<em>bean</em>".</p>

                    			    </td>
		    </tr>
	    </table>
    </body>
</html>
