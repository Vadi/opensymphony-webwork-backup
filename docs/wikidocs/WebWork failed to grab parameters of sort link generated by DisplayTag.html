<html>
    <head>
        <title>WebWork - 
        WebWork failed to grab parameters of sort link generated by DisplayTag
         </title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <p>This is due to WebWork attempting to parse the link ( eg. <a href="http://localhost:8080/etg-webapp/secure/reports/byReviewer.action?d-4002248-s=2&amp;etgId=2&amp;etgId=2&amp;d-4002248-o=1" title="Visit page outside Confluence">http://localhost:8080/etg-webapp/secure/reports/byReviewer.action?d-4002248-s=2&amp;etgId=2&amp;etgId=2&amp;d-4002248-o=1</a> ) using OGNL and OGNL treats eg. d-400248... as minus resulting in the undesired behaviour in dev mode.</p>

<p>The sollution would be to have WebWork action implements ParameterNameAware and filter out the offending parameter.</p>

<div class="code"><div class="codeContent">
<pre class="code-java"><span class="code-keyword">public</span> class MyAction <span class="code-keyword">extends</span> ActionSupport <span class="code-keyword">implements</span> ParameterNameAware {

   /**
    * This method will filter out parameters that
    * start with <span class="code-quote">"d-"</span> followed by a numeric digit,
    *  because parameters of <span class="code-keyword">this</span> form are generated by displayTag, 
    *  and are treated by webwork as an invalid OGNL expressions causing
    * webwork to <span class="code-keyword">throw</span> an ognl.InappropriateExpressionException exception.  
    * Note that the exception is only thrown when webwork is set in devmode.  
    * However, to prevent <span class="code-keyword">this</span> error, the ParameterNameAware <span class="code-keyword">interface</span> has been
    * implemented which requires <span class="code-keyword">this</span> method.
    * This method could be implemented more simply using java's regular expression 
    * support, but such an implementation may suffer from readability except <span class="code-keyword">for</span>
    * people who are very strong in understanding java's RegEX semantics.
    */
    <span class="code-keyword">public</span> <span class="code-object">boolean</span> acceptableParameterName(<span class="code-object">String</span> parameterName){
      <span class="code-object">boolean</span> retVal = <span class="code-keyword">true</span>;
      <span class="code-keyword">if</span>(parameterName!=<span class="code-keyword">null</span> &amp;&amp; parameterName.startsWith(<span class="code-quote">"d-"</span>) )
		 <span class="code-keyword">if</span>( parameterName.length()&gt;2) {
			<span class="code-object">String</span> thirdCharacter = parameterName.substring(2,3);
			<span class="code-keyword">if</span>(StringUtils.isNumeric(thirdCharacter)){
				retVal = <span class="code-keyword">false</span>;
			}
		}
      <span class="code-keyword">return</span> retVal;
    }
 }</pre>
</div></div>

<p>Special thanks to Richard Wallace and Philip Brown. The detailed dicussion is <a href="http://forums.opensymphony.com/thread.jspa?messageID=128594" title="Visit page outside Confluence">here</a></p>


                    			    </td>
		    </tr>
	    </table>
    </body>
</html>
